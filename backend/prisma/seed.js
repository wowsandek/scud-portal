const { PrismaClient } = require('@prisma/client');
const bcrypt = require('bcrypt');

const prisma = new PrismaClient();

async function main() {
  console.log('ðŸš€ Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…...');

  // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð°Ð´Ð¼Ð¸Ð½ÑÐºÐ¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
  const existingAdmin = await prisma.tenant.findUnique({ where: { name: 'admin' } });
  if (existingAdmin) {
    console.log('â„¹ï¸  ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚');
  } else {
    const passwordHash = await bcrypt.hash('adminpass', 10);
    await prisma.tenant.create({
      data: {
        name: 'admin',
        passwordHash,
        status: 'active',
        apiKey: 'admin-api-key-' + Math.random().toString(36).slice(2, 8),
        maxStaff: null,
        isDeleted: false
      }
    });
    console.log('âœ… ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ ÑÐ¾Ð·Ð´Ð°Ð½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾!');
    console.log('   Ð›Ð¾Ð³Ð¸Ð½: admin');
    console.log('   ÐŸÐ°Ñ€Ð¾Ð»ÑŒ: adminpass');
  }

  console.log('ðŸŽ‰ Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°!');
}

main().finally(() => prisma.$disconnect());
